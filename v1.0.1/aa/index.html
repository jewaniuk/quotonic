
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A platform for performing efficient simulations of nonlinear quantum photonic circuits.">
      
      
        <meta name="author" content="Jacob Ewaniuk">
      
      
        <link rel="canonical" href="https://jewaniuk.github.io/quotonic/v1.0.1/aa/">
      
      
        <link rel="prev" href="../clements/">
      
      
        <link rel="next" href="../nl/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>aa - quotonic</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
      <link rel="stylesheet" href="../styles/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quotonic.aa.gen_basis_combos" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="quotonic" class="md-header__button md-logo" aria-label="quotonic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            quotonic
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              aa
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/jewaniuk/quotonic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    jewaniuk/quotonic
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../fock/" class="md-tabs__link">
        
  
  
    
  
  fock

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../clements/" class="md-tabs__link">
        
  
  
    
  
  clements

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  aa

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../nl/" class="md-tabs__link">
        
  
  
    
  
  nl

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../qpnn/" class="md-tabs__link">
        
  
  
    
  
  qpnn

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../trainer/" class="md-tabs__link">
        
  
  
    
  
  trainer

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../training_sets/" class="md-tabs__link">
        
  
  
    
  
  training_sets

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../perm/" class="md-tabs__link">
        
  
  
    
  
  perm

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../logic/" class="md-tabs__link">
        
  
  
    
  
  logic

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../utils/" class="md-tabs__link">
        
  
  
    
  
  utils

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../types/" class="md-tabs__link">
        
  
  
    
  
  types

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="quotonic" class="md-nav__button md-logo" aria-label="quotonic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    quotonic
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jewaniuk/quotonic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    jewaniuk/quotonic
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../fock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fock
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../clements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    clements
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    aa
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    aa
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quotonic.aa.gen_basis_combos" class="md-nav__link">
    <span class="md-ellipsis">
      gen_basis_combos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quotonic.aa.calc_norm" class="md-nav__link">
    <span class="md-ellipsis">
      calc_norm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quotonic.aa.SecqTransformer" class="md-nav__link">
    <span class="md-ellipsis">
      SecqTransformer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SecqTransformer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quotonic.aa.SecqTransformer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quotonic.aa.SecqTransformer.transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../nl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nl
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../qpnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    qpnn
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    trainer
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../training_sets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    training_sets
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../perm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    perm
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../logic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    logic
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    types
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>aa</h1>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">

        <p>The <code>quotonic.aa</code> module includes functions and classes required to perform transformations from a single-photon
unitary matrix (<span class="arithmatex">\(m\times m\)</span> where <span class="arithmatex">\(m\)</span> is the number of optical modes) to a multi-photon unitary matrix (<span class="arithmatex">\(N\times
N\)</span> where <span class="arithmatex">\(N\)</span> is the dimension of the Fock basis for <span class="arithmatex">\(n\)</span> photons and <span class="arithmatex">\(m\)</span> modes). This transformation is required to
describe how unitaries encoded in the Clements configuration act on states resolved in a general basis of multiple
photons since <span class="arithmatex">\(N \neq m : n &gt; 1\)</span>.</p>
<p>The code in this module has been inspired by the description of multi-photon unitary transformations in <a href="https://arxiv.org/abs/1011.3245">S.
Aaronson &amp; A. Arkhipov, “The Computational Complexity of Linear Optics”, arXiv:1011.3245 [quant-ph] (2010)</a>, by <a href="https://github.com/steinbrecher/bosonic">Bosonic: A Quantum Optics Library</a>,
as originally designed for use in <a href="https://doi.org/10.1038/s41534-019-0174-7">G. R. Steinbrecher <em>et al</em>., “Quantum optical neural networks”, <em>npj Quantum Inf</em>
<strong>5</strong>, 60 (2019)</a>, and by <a href="https://github.com/JasvithBasani/CasOptAx">Cascaded Optical Systems Approach to Neural
Networks (CasOptAx)</a> as originally designed for use in <a href="https://doi.org/10.1038/s41534-025-01096-9">J. R. Basani <em>et
al</em>., "Universal logical quantum photonic neural network processor via cavity-assisted interactions", <em>npj Quantum
Inf</em> <strong>11</strong>, 142 (2025)</a>.</p>










  <div class="doc doc-children">































<div class="doc doc-object doc-function">


<h2 id="quotonic.aa.gen_basis_combos" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gen_basis_combos</span><span class="p">(</span><span class="n">basis</span><span class="p">)</span></code>

<a href="#quotonic.aa.gen_basis_combos" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Generate combinations of basis states corresponding to each element of a matrix resolved in the basis.</p>
<p>By placing the elements of the two tuples next to each other, you end up with (row, column) combinations for each
matrix element in the input basis. This is used to vectorially compute all matrix elements.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>basis</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="jnp_ndarray = jnp.ndarray

  
      module-attribute
   (quotonic.types.jnp_ndarray)" href="../types/#quotonic.types.jnp_ndarray">jnp_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><span class="arithmatex">\(N\times x\)</span> array that catalogs all states in the <span class="arithmatex">\(N\)</span>-dimensional basis, where each state has <span class="arithmatex">\(x\)</span> labels</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="jnp_ndarray = jnp.ndarray

  
      module-attribute
   (quotonic.types.jnp_ndarray)" href="../types/#quotonic.types.jnp_ndarray">jnp_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an <span class="arithmatex">\(N^2\times x\)</span> array where each state is repeated <span class="arithmatex">\(N\)</span> times vertically before moving to the next</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="jnp_ndarray = jnp.ndarray

  
      module-attribute
   (quotonic.types.jnp_ndarray)" href="../types/#quotonic.types.jnp_ndarray">jnp_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an <span class="arithmatex">\(N^2\times x\)</span> array where the entire basis is repeated in the order given <span class="arithmatex">\(N\)</span> times</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/quotonic/aa.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">gen_basis_combos</span><span class="p">(</span><span class="n">basis</span><span class="p">:</span> <span class="n">jnp_ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp_ndarray</span><span class="p">,</span> <span class="n">jnp_ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate combinations of basis states corresponding to each element of a matrix resolved in the basis.</span>

<span class="sd">    By placing the elements of the two tuples next to each other, you end up with (row, column) combinations for each</span>
<span class="sd">    matrix element in the input basis. This is used to vectorially compute all matrix elements.</span>

<span class="sd">    Args:</span>
<span class="sd">        basis: $N\\times x$ array that catalogs all states in the $N$-dimensional basis, where each state has $x$ labels</span>

<span class="sd">    Returns:</span>
<span class="sd">        an $N^2\\times x$ array where each state is repeated $N$ times vertically before moving to the next</span>
<span class="sd">        an $N^2\\times x$ array where the entire basis is repeated in the order given $N$ times</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">basis</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">basis</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h2 id="quotonic.aa.calc_norm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calc_norm</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span></code>

<a href="#quotonic.aa.calc_norm" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculate the normalization factor for an element of a multi-photon unitary in the second quantization Fock
basis.</p>
<p>Each normalization constant involves the product of factorials for each mode of the two basis states that define
an element of the multi-photon unitary <span class="arithmatex">\(\boldsymbol{\Phi}(\mathbf{U})\)</span>. The mathematical form of the
normalization constants is given in the documentation of <code>SecqTransformer.transform</code>. This function computes the
required product of factorials for each basis state, square roots this product, then combines all results in a
2D array that stores the normalization constant for  each element of <span class="arithmatex">\(\boldsymbol{\Phi}(\mathbf{U})\)</span> in the
corresponding position.</p>
<p>This function is wrapped by the <code>jax.vmap</code> decorator such that it can be used vectorially.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>S</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="jnp_ndarray = jnp.ndarray

  
      module-attribute
   (quotonic.types.jnp_ndarray)" href="../types/#quotonic.types.jnp_ndarray">jnp_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>state <span class="arithmatex">\(\left| S\right\rangle\)</span> corresponding to the row of the multi-photon unitary, length <span class="arithmatex">\(m\)</span></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>T</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="jnp_ndarray = jnp.ndarray

  
      module-attribute
   (quotonic.types.jnp_ndarray)" href="../types/#quotonic.types.jnp_ndarray">jnp_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>state <span class="arithmatex">\(\left| T\right\rangle\)</span> corresponding to the column of the multi-photon unitary, length <span class="arithmatex">\(m\)</span></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Normalization factor for symmetric multi-photon unitary element
<span class="arithmatex">\(\left\langle S\right|\boldsymbol{\Phi}(\mathbf{U})\left| T\right\rangle\)</span></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/quotonic/aa.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@vmap</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calc_norm</span><span class="p">(</span><span class="n">S</span><span class="p">:</span> <span class="n">jnp_ndarray</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="n">jnp_ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the normalization factor for an element of a multi-photon unitary in the second quantization Fock</span>
<span class="sd">    basis.</span>

<span class="sd">    Each normalization constant involves the product of factorials for each mode of the two basis states that define</span>
<span class="sd">    an element of the multi-photon unitary $\\boldsymbol{\\Phi}(\\mathbf{U})$. The mathematical form of the</span>
<span class="sd">    normalization constants is given in the documentation of `SecqTransformer.transform`. This function computes the</span>
<span class="sd">    required product of factorials for each basis state, square roots this product, then combines all results in a</span>
<span class="sd">    2D array that stores the normalization constant for  each element of $\\boldsymbol{\\Phi}(\\mathbf{U})$ in the</span>
<span class="sd">    corresponding position.</span>

<span class="sd">    This function is wrapped by the `jax.vmap` decorator such that it can be used vectorially.</span>

<span class="sd">    Args:</span>
<span class="sd">        S: state $\\left| S\\right\\rangle$ corresponding to the row of the multi-photon unitary, length $m$</span>
<span class="sd">        T: state $\\left| T\\right\\rangle$ corresponding to the column of the multi-photon unitary, length $m$</span>

<span class="sd">    Returns:</span>
<span class="sd">        Normalization factor for symmetric multi-photon unitary element</span>
<span class="sd">            $\\left\\langle S\\right|\\boldsymbol{\\Phi}(\\mathbf{U})\\left| T\\right\\rangle$</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">vectorial_factorial</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">)))))</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-class">



<h2 id="quotonic.aa.SecqTransformer" class="doc doc-heading">
            <code>SecqTransformer</code>


<a href="#quotonic.aa.SecqTransformer" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Wrapper class for performing multi-photon unitary transformations in the second quantization basis while the
required overhead is stored in memory.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="quotonic.aa.SecqTransformer.n">n</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>number of photons, <span class="arithmatex">\(n\)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quotonic.aa.SecqTransformer.N">N</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dimension of the second quantization Fock basis for <span class="arithmatex">\(n\)</span> photons and <span class="arithmatex">\(m\)</span> optical modes</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quotonic.aa.SecqTransformer.firq_combos">firq_combos</span></code></td>
            <td>
                  <code><span title="tuple">tuple</span>[<a class="autorefs autorefs-internal" title="jnp_ndarray = jnp.ndarray

  
      module-attribute
   (quotonic.types.jnp_ndarray)" href="../types/#quotonic.types.jnp_ndarray">jnp_ndarray</a>, <a class="autorefs autorefs-internal" title="jnp_ndarray = jnp.ndarray

  
      module-attribute
   (quotonic.types.jnp_ndarray)" href="../types/#quotonic.types.jnp_ndarray">jnp_ndarray</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple of <span class="arithmatex">\(N^2\times n\)</span> arrays, the first of which repeats each
first-quantized state <span class="arithmatex">\(N\)</span> times vertically before moving to the next state, the second of which repeats the
entire first-quantized basis (without indistinguishable duplicates) in the order given <span class="arithmatex">\(N\)</span> times; defaults
to a tuple of empty arrays if <span class="arithmatex">\(n = 1\)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quotonic.aa.SecqTransformer.norms">norms</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="jnp_ndarray = jnp.ndarray

  
      module-attribute
   (quotonic.types.jnp_ndarray)" href="../types/#quotonic.types.jnp_ndarray">jnp_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>normalization factors for each element of the multi-photon unitary, flattened to a
<span class="arithmatex">\(N^2\times 1\)</span> array, defaults to an empty array if <span class="arithmatex">\(n = 1\)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quotonic.aa.SecqTransformer.calculator">calculator</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Permanent (quotonic.perm.Permanent)" href="../perm/#quotonic.perm.Permanent">Permanent</a> | <a class="autorefs autorefs-internal" title="EmptyPermanent (quotonic.perm.EmptyPermanent)" href="../perm/#quotonic.perm.EmptyPermanent">EmptyPermanent</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>instance of a wrapped permanent calculator that computes overhead
for the selected algorithms ahead of time, defaults to EmptyPermanent if <span class="arithmatex">\(n = 1\)</span></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="quote">
                <summary>Source code in <code>src/quotonic/aa.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SecqTransformer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper class for performing multi-photon unitary transformations in the second quantization basis while the</span>
<span class="sd">    required overhead is stored in memory.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        n (int): number of photons, $n$</span>
<span class="sd">        N (int): dimension of the second quantization Fock basis for $n$ photons and $m$ optical modes</span>
<span class="sd">        firq_combos (tuple[jnp_ndarray, jnp_ndarray]): tuple of $N^2\\times n$ arrays, the first of which repeats each</span>
<span class="sd">            first-quantized state $N$ times vertically before moving to the next state, the second of which repeats the</span>
<span class="sd">            entire first-quantized basis (without indistinguishable duplicates) in the order given $N$ times; defaults</span>
<span class="sd">            to a tuple of empty arrays if $n = 1$</span>
<span class="sd">        norms (jnp_ndarray): normalization factors for each element of the multi-photon unitary, flattened to a</span>
<span class="sd">            $N^2\\times 1$ array, defaults to an empty array if $n = 1$</span>
<span class="sd">        calculator (Permanent | EmptyPermanent): instance of a wrapped permanent calculator that computes overhead</span>
<span class="sd">            for the selected algorithms ahead of time, defaults to EmptyPermanent if $n = 1$</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">algo</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bbfg&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialization of a Second Quantization Transformer.</span>

<span class="sd">        Args:</span>
<span class="sd">            n: number of photons, $n$</span>
<span class="sd">            m: number of optical modes, $m$</span>
<span class="sd">            algo: algorithm to compute permanents with if $n &gt; 3$, either &quot;bbfg&quot; or &quot;ryser&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># check the validity of the provided arguments</span>
        <span class="k">assert</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;There must be at least one photon for this class to be relevant&quot;</span>
        <span class="k">assert</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;There must be at least two optical modes for this class to be relevant&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># construct both bases representations</span>
            <span class="n">firq_basis</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">build_firq_basis_wo_dups</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>
            <span class="n">basis</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">build_secq_basis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># stack &amp; repeat the bases to form combinations that correspond to each multi-photon unitary matrix element</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">firq_combos</span> <span class="o">=</span> <span class="n">gen_basis_combos</span><span class="p">(</span><span class="n">firq_basis</span><span class="p">)</span>
            <span class="n">basis_combos</span> <span class="o">=</span> <span class="n">gen_basis_combos</span><span class="p">(</span><span class="n">basis</span><span class="p">)</span>

            <span class="c1"># vectorially compute the normalization factors for each element of the multi-photon unitary</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="p">:</span> <span class="n">jnp_ndarray</span> <span class="o">=</span> <span class="n">calc_norm</span><span class="p">(</span><span class="o">*</span><span class="n">basis_combos</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

            <span class="c1"># instantiate a permanent calculator</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculator</span><span class="p">:</span> <span class="n">Permanent</span> <span class="o">|</span> <span class="n">EmptyPermanent</span> <span class="o">=</span> <span class="n">Permanent</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">algo</span><span class="o">=</span><span class="n">algo</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">m</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">modeBasis_combos</span> <span class="o">=</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(()),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">norms</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculator</span> <span class="o">=</span> <span class="n">EmptyPermanent</span><span class="p">()</span>

    <span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnums</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">U</span><span class="p">:</span> <span class="n">jnp_ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp_ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform a multi-photon unitary transformation on a single-photon unitary $\\mathbf{U}$, in the second</span>
<span class="sd">        quantization Fock basis.</span>

<span class="sd">        This method constructs the corresponding multi-photon unitary, $\\boldsymbol{\\Phi}(\\mathbf{U})$, from input</span>
<span class="sd">        single-photon unitary $\\mathbf{U}$. Vectorially, each element of the multi-photon unitary $\\boldsymbol{</span>
<span class="sd">        \\Phi}(\\mathbf{U})$ is computed using the transformation of Aaronson &amp; Arkhipov. Each  element can be</span>
<span class="sd">        denoted as $\\left\\langle S \\right|\\boldsymbol{\\Phi}(\\mathbf{U})\\left| T \\right\\rangle$ where</span>
<span class="sd">        $\\left|S\\right\\rangle = \\left|s_1,s_2,\\dots,s_m\\right\\rangle$, $\\left|T\\right\\rangle = \\left|t_1,</span>
<span class="sd">        t_2,\\dots,t_m\\right\\rangle$ represent arbitrary Fock basis states and $m$ denotes the number of optical</span>
<span class="sd">        modes. For a given element, an $m\\times n$ matrix, $\\mathbf{U}_T$, is constructed by taking $t_j$ copies of</span>
<span class="sd">        column $j$ in the input single-photon unitary $\\mathbf{U}$ for all $j \\in \\{1,\\dots,m\\}$. Next,</span>
<span class="sd">        an $n\\times n$ matrix, $\\mathbf{U}_{S,T}$, is constructed by taking $s_j$ copies of row $j$ in the</span>
<span class="sd">        previously generated matrix, $\\mathbf{U}_T$, for all $j \\in \\{1,\\dots,m\\}$. The matrix element of</span>
<span class="sd">        multi-photon unitary, $\\boldsymbol{\\Phi}(\\mathbf{U})$ is then given by,</span>

<span class="sd">        $$ \\left\\langle S\\right|\\boldsymbol{\\Phi}(\\mathbf{U})\\left| T\\right\\rangle =</span>
<span class="sd">        \\left\\langle s_1,s_2,\\dots,s_m\\right| \\boldsymbol{\\Phi}(\\mathbf{U})\\left|t_1,t_2,\\dots,</span>
<span class="sd">        t_m\\right\\rangle = \\frac{\\text{Per}(\\mathbf{U}_{S,T})}{\\sqrt{s_1!\\dots s_m!t_1!\\dots t_m!}}. $$</span>

<span class="sd">        As an example, consider a case where there are 2 photons ($n = 2$) and 3 modes ($m = 3$). The input</span>
<span class="sd">        Clements-encoded single-photon unitary is given by,</span>

<span class="sd">        $$ \\mathbf{U} = \\begin{pmatrix} u_{00} &amp; u_{01} &amp; u_{02} \\\\ u_{10} &amp; u_{11} &amp; u_{12} \\\\ u_{20} &amp; u_{21}</span>
<span class="sd">        &amp; u_{22} \\end{pmatrix}. $$</span>

<span class="sd">        To compute the matrix element $\\left\\langle 101\\right|\\boldsymbol{\\Phi}(\\mathbf{U})\\left|011\\right</span>
<span class="sd">        \\rangle$, first build $\\mathbf{U}_T$ by taking 0 copies of the first column of $\\mathbf{U}$, 1 copy of the</span>
<span class="sd">        second, and 1 copy of the third,</span>

<span class="sd">        $$ \\mathbf{U}_T = \\begin{pmatrix} u_{01} &amp; u_{02} \\\\ u_{11} &amp; u_{12} \\\\ u_{21} &amp; u_{22} \\end{pmatrix}. $$</span>

<span class="sd">        Next, build $\\mathbf{U}_{S,T}$ by taking 1 copy of the first row of $\\mathbf{U}_T$, 0 copies of the second,</span>
<span class="sd">        and 1 copy of the third,</span>

<span class="sd">        $$ \\mathbf{U}_{S,T} = \\begin{pmatrix} u_{01} &amp; u_{02} \\\\ u_{21} &amp; u_{22} \\end{pmatrix}. $$</span>

<span class="sd">        The permanent of $\\mathbf{U}_{S,T}$ must be calculated to compute the corresponding matrix element of</span>
<span class="sd">        $\\boldsymbol{\\Phi}(\\mathbf{U})$. This is managed by the [perm](perm.md) module.</span>

<span class="sd">        Args:</span>
<span class="sd">            U: $m\\times m$ single-photon unitary, $\\mathbf{U}$, to transform</span>

<span class="sd">        Returns:</span>
<span class="sd">            PhiU: $N\\times N$ multi-photon unitary, $\\boldsymbol{\\Phi(\\mathbf{U})}$, in the $N$-dimensional Fock</span>
<span class="sd">                basis, that of $n$ photons and $m$ optical modes</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># no multi-photon unitary transformation is required if n = 1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">U</span>

        <span class="c1"># vectorially build all U_{S,T} matrices required to compute the multi-photon transform</span>
        <span class="n">U_STs</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="n">U</span><span class="p">[:,</span> <span class="n">T</span><span class="p">][</span><span class="n">S</span><span class="p">,</span> <span class="p">:])(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">firq_combos</span><span class="p">)</span>

        <span class="c1"># vectorially compute the permanents of all U_{S,T} matrices</span>
        <span class="n">perms</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculator</span><span class="o">.</span><span class="n">perm</span><span class="p">)(</span><span class="n">U_STs</span><span class="p">)</span>

        <span class="n">PhiU</span><span class="p">:</span> <span class="n">jnp_ndarray</span> <span class="o">=</span> <span class="p">(</span><span class="n">perms</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">PhiU</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-function">


<h3 id="quotonic.aa.SecqTransformer.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">algo</span><span class="o">=</span><span class="s1">&#39;bbfg&#39;</span><span class="p">)</span></code>

<a href="#quotonic.aa.SecqTransformer.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialization of a Second Quantization Transformer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>number of photons, <span class="arithmatex">\(n\)</span></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>m</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>number of optical modes, <span class="arithmatex">\(m\)</span></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>algo</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>algorithm to compute permanents with if <span class="arithmatex">\(n &gt; 3\)</span>, either "bbfg" or "ryser"</p>
              </div>
            </td>
            <td>
                  <code>&#39;bbfg&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/quotonic/aa.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">algo</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bbfg&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialization of a Second Quantization Transformer.</span>

<span class="sd">    Args:</span>
<span class="sd">        n: number of photons, $n$</span>
<span class="sd">        m: number of optical modes, $m$</span>
<span class="sd">        algo: algorithm to compute permanents with if $n &gt; 3$, either &quot;bbfg&quot; or &quot;ryser&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># check the validity of the provided arguments</span>
    <span class="k">assert</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;There must be at least one photon for this class to be relevant&quot;</span>
    <span class="k">assert</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;There must be at least two optical modes for this class to be relevant&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># construct both bases representations</span>
        <span class="n">firq_basis</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">build_firq_basis_wo_dups</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>
        <span class="n">basis</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">build_secq_basis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># stack &amp; repeat the bases to form combinations that correspond to each multi-photon unitary matrix element</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">firq_combos</span> <span class="o">=</span> <span class="n">gen_basis_combos</span><span class="p">(</span><span class="n">firq_basis</span><span class="p">)</span>
        <span class="n">basis_combos</span> <span class="o">=</span> <span class="n">gen_basis_combos</span><span class="p">(</span><span class="n">basis</span><span class="p">)</span>

        <span class="c1"># vectorially compute the normalization factors for each element of the multi-photon unitary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="p">:</span> <span class="n">jnp_ndarray</span> <span class="o">=</span> <span class="n">calc_norm</span><span class="p">(</span><span class="o">*</span><span class="n">basis_combos</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="c1"># instantiate a permanent calculator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculator</span><span class="p">:</span> <span class="n">Permanent</span> <span class="o">|</span> <span class="n">EmptyPermanent</span> <span class="o">=</span> <span class="n">Permanent</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">algo</span><span class="o">=</span><span class="n">algo</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modeBasis_combos</span> <span class="o">=</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(()),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norms</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculator</span> <span class="o">=</span> <span class="n">EmptyPermanent</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="quotonic.aa.SecqTransformer.transform" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transform</span><span class="p">(</span><span class="n">U</span><span class="p">)</span></code>

<a href="#quotonic.aa.SecqTransformer.transform" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Perform a multi-photon unitary transformation on a single-photon unitary <span class="arithmatex">\(\mathbf{U}\)</span>, in the second
quantization Fock basis.</p>
<p>This method constructs the corresponding multi-photon unitary, <span class="arithmatex">\(\boldsymbol{\Phi}(\mathbf{U})\)</span>, from input
single-photon unitary <span class="arithmatex">\(\mathbf{U}\)</span>. Vectorially, each element of the multi-photon unitary <span class="arithmatex">\(\boldsymbol{
\Phi}(\mathbf{U})\)</span> is computed using the transformation of Aaronson &amp; Arkhipov. Each  element can be
denoted as <span class="arithmatex">\(\left\langle S \right|\boldsymbol{\Phi}(\mathbf{U})\left| T \right\rangle\)</span> where
<span class="arithmatex">\(\left|S\right\rangle = \left|s_1,s_2,\dots,s_m\right\rangle\)</span>, <span class="arithmatex">\(\left|T\right\rangle = \left|t_1,
t_2,\dots,t_m\right\rangle\)</span> represent arbitrary Fock basis states and <span class="arithmatex">\(m\)</span> denotes the number of optical
modes. For a given element, an <span class="arithmatex">\(m\times n\)</span> matrix, <span class="arithmatex">\(\mathbf{U}_T\)</span>, is constructed by taking <span class="arithmatex">\(t_j\)</span> copies of
column <span class="arithmatex">\(j\)</span> in the input single-photon unitary <span class="arithmatex">\(\mathbf{U}\)</span> for all <span class="arithmatex">\(j \in \{1,\dots,m\}\)</span>. Next,
an <span class="arithmatex">\(n\times n\)</span> matrix, <span class="arithmatex">\(\mathbf{U}_{S,T}\)</span>, is constructed by taking <span class="arithmatex">\(s_j\)</span> copies of row <span class="arithmatex">\(j\)</span> in the
previously generated matrix, <span class="arithmatex">\(\mathbf{U}_T\)</span>, for all <span class="arithmatex">\(j \in \{1,\dots,m\}\)</span>. The matrix element of
multi-photon unitary, <span class="arithmatex">\(\boldsymbol{\Phi}(\mathbf{U})\)</span> is then given by,</p>
<div class="arithmatex">\[ \left\langle S\right|\boldsymbol{\Phi}(\mathbf{U})\left| T\right\rangle =
\left\langle s_1,s_2,\dots,s_m\right| \boldsymbol{\Phi}(\mathbf{U})\left|t_1,t_2,\dots,
t_m\right\rangle = \frac{\text{Per}(\mathbf{U}_{S,T})}{\sqrt{s_1!\dots s_m!t_1!\dots t_m!}}. \]</div>
<p>As an example, consider a case where there are 2 photons (<span class="arithmatex">\(n = 2\)</span>) and 3 modes (<span class="arithmatex">\(m = 3\)</span>). The input
Clements-encoded single-photon unitary is given by,</p>
<div class="arithmatex">\[ \mathbf{U} = \begin{pmatrix} u_{00} &amp; u_{01} &amp; u_{02} \\ u_{10} &amp; u_{11} &amp; u_{12} \\ u_{20} &amp; u_{21}
&amp; u_{22} \end{pmatrix}. \]</div>
<p>To compute the matrix element <span class="arithmatex">\(\left\langle 101\right|\boldsymbol{\Phi}(\mathbf{U})\left|011\right
\rangle\)</span>, first build <span class="arithmatex">\(\mathbf{U}_T\)</span> by taking 0 copies of the first column of <span class="arithmatex">\(\mathbf{U}\)</span>, 1 copy of the
second, and 1 copy of the third,</p>
<div class="arithmatex">\[ \mathbf{U}_T = \begin{pmatrix} u_{01} &amp; u_{02} \\ u_{11} &amp; u_{12} \\ u_{21} &amp; u_{22} \end{pmatrix}. \]</div>
<p>Next, build <span class="arithmatex">\(\mathbf{U}_{S,T}\)</span> by taking 1 copy of the first row of <span class="arithmatex">\(\mathbf{U}_T\)</span>, 0 copies of the second,
and 1 copy of the third,</p>
<div class="arithmatex">\[ \mathbf{U}_{S,T} = \begin{pmatrix} u_{01} &amp; u_{02} \\ u_{21} &amp; u_{22} \end{pmatrix}. \]</div>
<p>The permanent of <span class="arithmatex">\(\mathbf{U}_{S,T}\)</span> must be calculated to compute the corresponding matrix element of
<span class="arithmatex">\(\boldsymbol{\Phi}(\mathbf{U})\)</span>. This is managed by the <a href="../perm/">perm</a> module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>U</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="jnp_ndarray = jnp.ndarray

  
      module-attribute
   (quotonic.types.jnp_ndarray)" href="../types/#quotonic.types.jnp_ndarray">jnp_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><span class="arithmatex">\(m\times m\)</span> single-photon unitary, <span class="arithmatex">\(\mathbf{U}\)</span>, to transform</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PhiU</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="jnp_ndarray = jnp.ndarray

  
      module-attribute
   (quotonic.types.jnp_ndarray)" href="../types/#quotonic.types.jnp_ndarray">jnp_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><span class="arithmatex">\(N\times N\)</span> multi-photon unitary, <span class="arithmatex">\(\boldsymbol{\Phi(\mathbf{U})}\)</span>, in the <span class="arithmatex">\(N\)</span>-dimensional Fock
basis, that of <span class="arithmatex">\(n\)</span> photons and <span class="arithmatex">\(m\)</span> optical modes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/quotonic/aa.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnums</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">U</span><span class="p">:</span> <span class="n">jnp_ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp_ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform a multi-photon unitary transformation on a single-photon unitary $\\mathbf{U}$, in the second</span>
<span class="sd">    quantization Fock basis.</span>

<span class="sd">    This method constructs the corresponding multi-photon unitary, $\\boldsymbol{\\Phi}(\\mathbf{U})$, from input</span>
<span class="sd">    single-photon unitary $\\mathbf{U}$. Vectorially, each element of the multi-photon unitary $\\boldsymbol{</span>
<span class="sd">    \\Phi}(\\mathbf{U})$ is computed using the transformation of Aaronson &amp; Arkhipov. Each  element can be</span>
<span class="sd">    denoted as $\\left\\langle S \\right|\\boldsymbol{\\Phi}(\\mathbf{U})\\left| T \\right\\rangle$ where</span>
<span class="sd">    $\\left|S\\right\\rangle = \\left|s_1,s_2,\\dots,s_m\\right\\rangle$, $\\left|T\\right\\rangle = \\left|t_1,</span>
<span class="sd">    t_2,\\dots,t_m\\right\\rangle$ represent arbitrary Fock basis states and $m$ denotes the number of optical</span>
<span class="sd">    modes. For a given element, an $m\\times n$ matrix, $\\mathbf{U}_T$, is constructed by taking $t_j$ copies of</span>
<span class="sd">    column $j$ in the input single-photon unitary $\\mathbf{U}$ for all $j \\in \\{1,\\dots,m\\}$. Next,</span>
<span class="sd">    an $n\\times n$ matrix, $\\mathbf{U}_{S,T}$, is constructed by taking $s_j$ copies of row $j$ in the</span>
<span class="sd">    previously generated matrix, $\\mathbf{U}_T$, for all $j \\in \\{1,\\dots,m\\}$. The matrix element of</span>
<span class="sd">    multi-photon unitary, $\\boldsymbol{\\Phi}(\\mathbf{U})$ is then given by,</span>

<span class="sd">    $$ \\left\\langle S\\right|\\boldsymbol{\\Phi}(\\mathbf{U})\\left| T\\right\\rangle =</span>
<span class="sd">    \\left\\langle s_1,s_2,\\dots,s_m\\right| \\boldsymbol{\\Phi}(\\mathbf{U})\\left|t_1,t_2,\\dots,</span>
<span class="sd">    t_m\\right\\rangle = \\frac{\\text{Per}(\\mathbf{U}_{S,T})}{\\sqrt{s_1!\\dots s_m!t_1!\\dots t_m!}}. $$</span>

<span class="sd">    As an example, consider a case where there are 2 photons ($n = 2$) and 3 modes ($m = 3$). The input</span>
<span class="sd">    Clements-encoded single-photon unitary is given by,</span>

<span class="sd">    $$ \\mathbf{U} = \\begin{pmatrix} u_{00} &amp; u_{01} &amp; u_{02} \\\\ u_{10} &amp; u_{11} &amp; u_{12} \\\\ u_{20} &amp; u_{21}</span>
<span class="sd">    &amp; u_{22} \\end{pmatrix}. $$</span>

<span class="sd">    To compute the matrix element $\\left\\langle 101\\right|\\boldsymbol{\\Phi}(\\mathbf{U})\\left|011\\right</span>
<span class="sd">    \\rangle$, first build $\\mathbf{U}_T$ by taking 0 copies of the first column of $\\mathbf{U}$, 1 copy of the</span>
<span class="sd">    second, and 1 copy of the third,</span>

<span class="sd">    $$ \\mathbf{U}_T = \\begin{pmatrix} u_{01} &amp; u_{02} \\\\ u_{11} &amp; u_{12} \\\\ u_{21} &amp; u_{22} \\end{pmatrix}. $$</span>

<span class="sd">    Next, build $\\mathbf{U}_{S,T}$ by taking 1 copy of the first row of $\\mathbf{U}_T$, 0 copies of the second,</span>
<span class="sd">    and 1 copy of the third,</span>

<span class="sd">    $$ \\mathbf{U}_{S,T} = \\begin{pmatrix} u_{01} &amp; u_{02} \\\\ u_{21} &amp; u_{22} \\end{pmatrix}. $$</span>

<span class="sd">    The permanent of $\\mathbf{U}_{S,T}$ must be calculated to compute the corresponding matrix element of</span>
<span class="sd">    $\\boldsymbol{\\Phi}(\\mathbf{U})$. This is managed by the [perm](perm.md) module.</span>

<span class="sd">    Args:</span>
<span class="sd">        U: $m\\times m$ single-photon unitary, $\\mathbf{U}$, to transform</span>

<span class="sd">    Returns:</span>
<span class="sd">        PhiU: $N\\times N$ multi-photon unitary, $\\boldsymbol{\\Phi(\\mathbf{U})}$, in the $N$-dimensional Fock</span>
<span class="sd">            basis, that of $n$ photons and $m$ optical modes</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># no multi-photon unitary transformation is required if n = 1</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">U</span>

    <span class="c1"># vectorially build all U_{S,T} matrices required to compute the multi-photon transform</span>
    <span class="n">U_STs</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="n">U</span><span class="p">[:,</span> <span class="n">T</span><span class="p">][</span><span class="n">S</span><span class="p">,</span> <span class="p">:])(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">firq_combos</span><span class="p">)</span>

    <span class="c1"># vectorially compute the permanents of all U_{S,T} matrices</span>
    <span class="n">perms</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculator</span><span class="o">.</span><span class="n">perm</span><span class="p">)(</span><span class="n">U_STs</span><span class="p">)</span>

    <span class="n">PhiU</span><span class="p">:</span> <span class="n">jnp_ndarray</span> <span class="o">=</span> <span class="p">(</span><span class="n">perms</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">PhiU</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Maintained by <a href="https://www.linkedin.com/in/jacobewaniuk/">Jacob Ewaniuk</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/jewaniuk/quotonic" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/quotonic" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.tracking", "toc.integrate", "navigation.instant", "navigation.top", "navigation.tabs", "navigation.prune"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../js/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>