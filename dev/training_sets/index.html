
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A platform for performing efficient simulations of nonlinear quantum photonic circuits.">
      
      
        <meta name="author" content="Jacob Ewaniuk">
      
      
        <link rel="canonical" href="https://jewaniuk.github.io/quotonic/dev/training_sets/">
      
      
        <link rel="prev" href="../trainer/">
      
      
        <link rel="next" href="../perm/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>training_sets - quotonic</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
      <link rel="stylesheet" href="../styles/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quotonic.training_sets.CNOT" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="quotonic" class="md-header__button md-logo" aria-label="quotonic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            quotonic
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              training_sets
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/jewaniuk/quotonic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    jewaniuk/quotonic
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../fock/" class="md-tabs__link">
        
  
  
    
  
  fock

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../clements/" class="md-tabs__link">
        
  
  
    
  
  clements

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../aa/" class="md-tabs__link">
        
  
  
    
  
  aa

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../nl/" class="md-tabs__link">
        
  
  
    
  
  nl

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../qpnn/" class="md-tabs__link">
        
  
  
    
  
  qpnn

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../trainer/" class="md-tabs__link">
        
  
  
    
  
  trainer

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  training_sets

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../perm/" class="md-tabs__link">
        
  
  
    
  
  perm

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../logic/" class="md-tabs__link">
        
  
  
    
  
  logic

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../utils/" class="md-tabs__link">
        
  
  
    
  
  utils

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../types/" class="md-tabs__link">
        
  
  
    
  
  types

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="quotonic" class="md-nav__button md-logo" aria-label="quotonic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    quotonic
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jewaniuk/quotonic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    jewaniuk/quotonic
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../fock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fock
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../clements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    clements
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    aa
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../nl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nl
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../qpnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    qpnn
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    trainer
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    training_sets
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    training_sets
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quotonic.training_sets.CNOT" class="md-nav__link">
    <span class="md-ellipsis">
      CNOT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quotonic.training_sets.CZ" class="md-nav__link">
    <span class="md-ellipsis">
      CZ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quotonic.training_sets.BSA" class="md-nav__link">
    <span class="md-ellipsis">
      BSA
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quotonic.training_sets.Tree" class="md-nav__link">
    <span class="md-ellipsis">
      Tree
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../perm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    perm
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../logic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    logic
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    types
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>training_sets</h1>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">

        <p>The <code>quotonic.training_sets</code> module includes functions that are used to prepare training sets for quantum photonic
neural network (QPNN) training simulations. Training sets can vary depending on the specific QPNN model used and the
considered application. That being said, these functions typically return a set of input-target state pairs, where the
QPNN should be trained to map each input state to its corresponding target state (see <a href="../qpnn/">qpnn</a> and
<a href="../trainer/">trainer</a> for more details on network models and training, respectively). Depending on the specific task,
these states may be resolved in a first-quantized basis, the second-quantized Fock basis, or the computational basis of
the photonic qubits. As a result, the <a href="../fock/">fock</a> and <a href="../logic/">logic</a> modules are particularly useful in these
functions.</p>
<p>If you decide to use <code>quotonic</code> to perform research on QPNNs, feel free to develop a training set function to go with
your QPNN model. Also, we'd be happy to add it if it fits the format appropriately, so please reach out!</p>










  <div class="doc doc-children">























<div class="doc doc-object doc-function">


<h2 id="quotonic.training_sets.CNOT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CNOT</span><span class="p">()</span></code>

<a href="#quotonic.training_sets.CNOT" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Construct training set for a dual-rail encoded QPNN-based CNOT gate, resolved in the second-quantized Fock basis.</p>
<p>See <a href="../logic/">logic</a> for more details on CNOT gates from a logical standpoint. The truth table is as follows,
where a logical 0 (1) state is defined as <span class="arithmatex">\(\left|0\right\rangle_\mathrm{log} \equiv \left|10\right\rangle\)</span>
(<span class="arithmatex">\(\left|1\right\rangle_\mathrm{log} \equiv \left|01\right\rangle\)</span>) for the dual-rail encoding considered
here.</p>
<table>
  <thead>
    <tr><th>$\left|\mathrm{in}\right\rangle$</th><th>$\left|\mathrm{targ}\right\rangle$</th></tr>
  </thead>
  <tbody>
    <tr><td>$\left|1010\right\rangle$</td><td>$\left|1010\right\rangle$</td></tr>
    <tr><td>$\left|1001\right\rangle$</td><td>$\left|1001\right\rangle$</td></tr>
    <tr><td>$\left|0110\right\rangle$</td><td>$\left|0101\right\rangle$</td></tr>
    <tr><td>$\left|0101\right\rangle$</td><td>$\left|0110\right\rangle$</td></tr>
  </tbody>
</table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>psi_in</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="np_ndarray = np.ndarray

  
      module-attribute
   (quotonic.types.np_ndarray)" href="../types/#quotonic.types.np_ndarray">np_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><span class="arithmatex">\(K\times N\)</span> array containing the <span class="arithmatex">\(K\)</span> input states resolved in the <span class="arithmatex">\(N\)</span>-dimensional second quantization
Fock basis</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>psi_targ</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="np_ndarray = np.ndarray

  
      module-attribute
   (quotonic.types.np_ndarray)" href="../types/#quotonic.types.np_ndarray">np_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><span class="arithmatex">\(K\times N\)</span> array containing the <span class="arithmatex">\(K\)</span> target states resolved in the <span class="arithmatex">\(N\)</span>-dimensional second
quantization Fock basis</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/quotonic/training_sets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">CNOT</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np_ndarray</span><span class="p">,</span> <span class="n">np_ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct training set for a dual-rail encoded QPNN-based CNOT gate, resolved in the second-quantized Fock basis.</span>

<span class="sd">    See [logic](logic.md) for more details on CNOT gates from a logical standpoint. The truth table is as follows,</span>
<span class="sd">    where a logical 0 (1) state is defined as $\\left|0\\right\\rangle_\\mathrm{log} \\equiv \\left|10\\right\\rangle$</span>
<span class="sd">    ($\\left|1\\right\\rangle_\\mathrm{log} \\equiv \\left|01\\right\\rangle$) for the dual-rail encoding considered</span>
<span class="sd">    here.</span>

<span class="sd">    &lt;table&gt;</span>
<span class="sd">      &lt;thead&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;th&gt;$\\left|\\mathrm{in}\\right\\rangle$&lt;/th&gt;&lt;th&gt;$\\left|\\mathrm{targ}\\right\\rangle$&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;/thead&gt;</span>
<span class="sd">      &lt;tbody&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|1010\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\left|1010\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|1001\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\left|1001\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|0110\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\left|0101\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|0101\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\left|0110\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;/tbody&gt;</span>
<span class="sd">    &lt;/table&gt;</span>

<span class="sd">    Returns:</span>
<span class="sd">        psi_in: $K\\times N$ array containing the $K$ input states resolved in the $N$-dimensional second quantization</span>
<span class="sd">            Fock basis</span>
<span class="sd">        psi_targ: $K\\times N$ array containing the $K$ target states resolved in the $N$-dimensional second</span>
<span class="sd">            quantization Fock basis</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># define number of photons, optical modes, and input-target state pairs,</span>
    <span class="c1"># which is equivalent to the dimension of the computational basis in this case</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">K</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">n</span>

    <span class="c1"># build the N-dim Fock basis and a list of indices in it where the corresponding computational basis states lie</span>
    <span class="n">fock_basis</span> <span class="o">=</span> <span class="n">build_secq_basis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">fock_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">comp_indices</span> <span class="o">=</span> <span class="n">comp_indices_from_secq</span><span class="p">(</span><span class="n">fock_basis</span><span class="p">)</span>

    <span class="c1"># all the input states in the computational basis can be extracted from the identity matrix of the same dimension</span>
    <span class="n">psi_in_comps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

    <span class="c1"># build the gate in the computational basis to easily compute the target states in the computational basis</span>
    <span class="n">gate</span> <span class="o">=</span> <span class="n">logic</span><span class="o">.</span><span class="n">CNOT</span><span class="p">()</span>

    <span class="c1"># for each input-target pair, compute the target in the computational basis, then convert both to the Fock basis</span>
    <span class="n">psi_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">psi_targ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">psi_in_comp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">psi_in_comps</span><span class="p">):</span>
        <span class="n">psi_targ_comp</span> <span class="o">=</span> <span class="n">gate</span> <span class="o">@</span> <span class="n">psi_in_comp</span>

        <span class="n">psi_in</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">comp_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi_in_comp</span>
        <span class="n">psi_targ</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">comp_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi_targ_comp</span>

    <span class="k">return</span> <span class="n">psi_in</span><span class="p">,</span> <span class="n">psi_targ</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h2 id="quotonic.training_sets.CZ" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">CZ</span><span class="p">()</span></code>

<a href="#quotonic.training_sets.CZ" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Construct training set for a dual-rail encoded QPNN-based CZ gate, resolved in the second-quantized Fock basis.</p>
<p>See <a href="../logic/">logic</a> for more details on CZ gates from a logical standpoint. The truth table is as follows,
where a logical 0 (1) state is defined as <span class="arithmatex">\(\left|0\right\rangle_\mathrm{log} \equiv \left|10\right\rangle\)</span>
(<span class="arithmatex">\(\left|1\right\rangle_\mathrm{log} \equiv \left|01\right\rangle\)</span>) for the dual-rail encoding considered
here.</p>
<table>
  <thead>
    <tr><th>$\left|\mathrm{in}\right\rangle$</th><th>$\left|\mathrm{targ}\right\rangle$</th></tr>
  </thead>
  <tbody>
    <tr><td>$\left|1010\right\rangle$</td><td>$+\left|1010\right\rangle$</td></tr>
    <tr><td>$\left|1001\right\rangle$</td><td>$+\left|1001\right\rangle$</td></tr>
    <tr><td>$\left|0110\right\rangle$</td><td>$+\left|0110\right\rangle$</td></tr>
    <tr><td>$\left|0101\right\rangle$</td><td>$-\left|0101\right\rangle$</td></tr>
  </tbody>
</table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>psi_in</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="np_ndarray = np.ndarray

  
      module-attribute
   (quotonic.types.np_ndarray)" href="../types/#quotonic.types.np_ndarray">np_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><span class="arithmatex">\(K\times N\)</span> array containing the <span class="arithmatex">\(K\)</span> input states resolved in the <span class="arithmatex">\(N\)</span>-dimensional second quantization
Fock basis</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>psi_targ</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="np_ndarray = np.ndarray

  
      module-attribute
   (quotonic.types.np_ndarray)" href="../types/#quotonic.types.np_ndarray">np_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><span class="arithmatex">\(K\times N\)</span> array containing the <span class="arithmatex">\(K\)</span> target states resolved in the <span class="arithmatex">\(N\)</span>-dimensional second
quantization Fock basis</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/quotonic/training_sets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">CZ</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np_ndarray</span><span class="p">,</span> <span class="n">np_ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct training set for a dual-rail encoded QPNN-based CZ gate, resolved in the second-quantized Fock basis.</span>

<span class="sd">    See [logic](logic.md) for more details on CZ gates from a logical standpoint. The truth table is as follows,</span>
<span class="sd">    where a logical 0 (1) state is defined as $\\left|0\\right\\rangle_\\mathrm{log} \\equiv \\left|10\\right\\rangle$</span>
<span class="sd">    ($\\left|1\\right\\rangle_\\mathrm{log} \\equiv \\left|01\\right\\rangle$) for the dual-rail encoding considered</span>
<span class="sd">    here.</span>

<span class="sd">    &lt;table&gt;</span>
<span class="sd">      &lt;thead&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;th&gt;$\\left|\\mathrm{in}\\right\\rangle$&lt;/th&gt;&lt;th&gt;$\\left|\\mathrm{targ}\\right\\rangle$&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;/thead&gt;</span>
<span class="sd">      &lt;tbody&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|1010\\right\\rangle$&lt;/td&gt;&lt;td&gt;$+\\left|1010\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|1001\\right\\rangle$&lt;/td&gt;&lt;td&gt;$+\\left|1001\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|0110\\right\\rangle$&lt;/td&gt;&lt;td&gt;$+\\left|0110\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|0101\\right\\rangle$&lt;/td&gt;&lt;td&gt;$-\\left|0101\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;/tbody&gt;</span>
<span class="sd">    &lt;/table&gt;</span>

<span class="sd">    Returns:</span>
<span class="sd">        psi_in: $K\\times N$ array containing the $K$ input states resolved in the $N$-dimensional second quantization</span>
<span class="sd">            Fock basis</span>
<span class="sd">        psi_targ: $K\\times N$ array containing the $K$ target states resolved in the $N$-dimensional second</span>
<span class="sd">            quantization Fock basis</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># define number of photons, optical modes, and input-target state pairs,</span>
    <span class="c1"># which is equivalent to the dimension of the computational basis in this case</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">K</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">n</span>

    <span class="c1"># build the N-dim Fock basis and a list of indices in it where the corresponding computational basis states lie</span>
    <span class="n">fock_basis</span> <span class="o">=</span> <span class="n">build_secq_basis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">fock_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">comp_indices</span> <span class="o">=</span> <span class="n">comp_indices_from_secq</span><span class="p">(</span><span class="n">fock_basis</span><span class="p">)</span>

    <span class="c1"># all the input states in the computational basis can be extracted from the identity matrix of the same dimension</span>
    <span class="n">psi_in_comps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

    <span class="c1"># build the gate in the computational basis to easily compute the target states in the computational basis</span>
    <span class="n">gate</span> <span class="o">=</span> <span class="n">logic</span><span class="o">.</span><span class="n">CZ</span><span class="p">()</span>

    <span class="c1"># for each input-target pairs, compute the target in the computational basis, then convert both to the Fock basis</span>
    <span class="n">psi_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">psi_targ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">psi_in_comp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">psi_in_comps</span><span class="p">):</span>
        <span class="n">psi_targ_comp</span> <span class="o">=</span> <span class="n">gate</span> <span class="o">@</span> <span class="n">psi_in_comp</span>

        <span class="n">psi_in</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">comp_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi_in_comp</span>
        <span class="n">psi_targ</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">comp_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi_targ_comp</span>

    <span class="k">return</span> <span class="n">psi_in</span><span class="p">,</span> <span class="n">psi_targ</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h2 id="quotonic.training_sets.BSA" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">BSA</span><span class="p">()</span></code>

<a href="#quotonic.training_sets.BSA" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Construct training set for a dual-rail encoded QPNN-based Bell State Analyzer, resolved in the
    second-quantized Fock basis.</p>
<p>See <a href="../logic/">logic</a> for more details on BSA gates from a logical standpoint. The truth table is as follows,
where a logical 0 (1) state is defined as <span class="arithmatex">\(\left|0\right\rangle_\mathrm{log} \equiv \left|10\right\rangle\)</span>
(<span class="arithmatex">\(\left|1\right\rangle_\mathrm{log} \equiv \left|01\right\rangle\)</span>) for the dual-rail encoding considered
here.</p>
<table>
  <thead>
    <tr><th>$\left|\mathrm{in}\right\rangle$</th><th>$\left|\mathrm{targ}\right\rangle$</th></tr>
  </thead>
  <tbody>
    <tr><td>$\left|\Phi^+\right\rangle \equiv \frac{1}{\sqrt{2}}\left(\left|1010\right\rangle +
    \left|0101\right\rangle\right)$</td><td>$\left|1010\right\rangle$</td></tr>
    <tr><td>$\left|\Phi^-\right\rangle \equiv \frac{1}{\sqrt{2}}\left(\left|1010\right\rangle -
    \left|0101\right\rangle\right)$</td><td>$\left|0110\right\rangle$</td></tr>
    <tr><td>$\left|\Psi^+\right\rangle \equiv \frac{1}{\sqrt{2}}\left(\left|1001\right\rangle +
    \left|0110\right\rangle\right)$</td><td>$\left|1001\right\rangle$</td></tr>
    <tr><td>$\left|\Psi^-\right\rangle \equiv \frac{1}{\sqrt{2}}\left(\left|1001\right\rangle -
    \left|0110\right\rangle\right)$</td><td>$\left|0101\right\rangle$</td></tr>
  </tbody>
</table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>psi_in</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="np_ndarray = np.ndarray

  
      module-attribute
   (quotonic.types.np_ndarray)" href="../types/#quotonic.types.np_ndarray">np_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><span class="arithmatex">\(K\times N\)</span> array containing the <span class="arithmatex">\(K\)</span> input states resolved in the <span class="arithmatex">\(N\)</span>-dimensional second quantization
Fock basis</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>psi_targ</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="np_ndarray = np.ndarray

  
      module-attribute
   (quotonic.types.np_ndarray)" href="../types/#quotonic.types.np_ndarray">np_ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><span class="arithmatex">\(K\times N\)</span> array containing the <span class="arithmatex">\(K\)</span> target states resolved in the <span class="arithmatex">\(N\)</span>-dimensional second
quantization Fock basis</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/quotonic/training_sets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">BSA</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np_ndarray</span><span class="p">,</span> <span class="n">np_ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct training set for a dual-rail encoded QPNN-based Bell State Analyzer, resolved in the</span>
<span class="sd">        second-quantized Fock basis.</span>

<span class="sd">    See [logic](logic.md) for more details on BSA gates from a logical standpoint. The truth table is as follows,</span>
<span class="sd">    where a logical 0 (1) state is defined as $\\left|0\\right\\rangle_\\mathrm{log} \\equiv \\left|10\\right\\rangle$</span>
<span class="sd">    ($\\left|1\\right\\rangle_\\mathrm{log} \\equiv \\left|01\\right\\rangle$) for the dual-rail encoding considered</span>
<span class="sd">    here.</span>

<span class="sd">    &lt;table&gt;</span>
<span class="sd">      &lt;thead&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;th&gt;$\\left|\\mathrm{in}\\right\\rangle$&lt;/th&gt;&lt;th&gt;$\\left|\\mathrm{targ}\\right\\rangle$&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;/thead&gt;</span>
<span class="sd">      &lt;tbody&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|\\Phi^+\\right\\rangle \\equiv \\frac{1}{\\sqrt{2}}\\left(\\left|1010\\right\\rangle +</span>
<span class="sd">        \\left|0101\\right\\rangle\\right)$&lt;/td&gt;&lt;td&gt;$\\left|1010\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|\\Phi^-\\right\\rangle \\equiv \\frac{1}{\\sqrt{2}}\\left(\\left|1010\\right\\rangle -</span>
<span class="sd">        \\left|0101\\right\\rangle\\right)$&lt;/td&gt;&lt;td&gt;$\\left|0110\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|\\Psi^+\\right\\rangle \\equiv \\frac{1}{\\sqrt{2}}\\left(\\left|1001\\right\\rangle +</span>
<span class="sd">        \\left|0110\\right\\rangle\\right)$&lt;/td&gt;&lt;td&gt;$\\left|1001\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|\\Psi^-\\right\\rangle \\equiv \\frac{1}{\\sqrt{2}}\\left(\\left|1001\\right\\rangle -</span>
<span class="sd">        \\left|0110\\right\\rangle\\right)$&lt;/td&gt;&lt;td&gt;$\\left|0101\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;/tbody&gt;</span>
<span class="sd">    &lt;/table&gt;</span>

<span class="sd">    Returns:</span>
<span class="sd">        psi_in: $K\\times N$ array containing the $K$ input states resolved in the $N$-dimensional second quantization</span>
<span class="sd">            Fock basis</span>
<span class="sd">        psi_targ: $K\\times N$ array containing the $K$ target states resolved in the $N$-dimensional second</span>
<span class="sd">            quantization Fock basis</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># define number of photons, optical modes, and input-target state pairs,</span>
    <span class="c1"># which is equivalent to the dimension of the computational basis in this case</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">K</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">n</span>

    <span class="c1"># build the N-dim Fock basis and a list of indices in it where the corresponding computational basis states lie</span>
    <span class="n">fock_basis</span> <span class="o">=</span> <span class="n">build_secq_basis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">fock_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">comp_indices</span> <span class="o">=</span> <span class="n">comp_indices_from_secq</span><span class="p">(</span><span class="n">fock_basis</span><span class="p">)</span>

    <span class="c1"># generate the input states in the computational basis</span>
    <span class="n">c00</span><span class="p">,</span> <span class="n">c01</span><span class="p">,</span> <span class="n">c10</span><span class="p">,</span> <span class="n">c11</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">psi_in_comps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">K</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">psi_in_comps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c00</span> <span class="o">+</span> <span class="n">c11</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">psi_in_comps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c00</span> <span class="o">-</span> <span class="n">c11</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">psi_in_comps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c01</span> <span class="o">+</span> <span class="n">c10</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">psi_in_comps</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c01</span> <span class="o">-</span> <span class="n">c10</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># build the gate in the computational basis to easily compute the target states in the computational basis</span>
    <span class="n">gate</span> <span class="o">=</span> <span class="n">logic</span><span class="o">.</span><span class="n">BSA</span><span class="p">()</span>

    <span class="c1"># for each input-target pair, compute the target in the computational basis, then convert both to the Fock basis</span>
    <span class="n">psi_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">psi_targ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">psi_in_comp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">psi_in_comps</span><span class="p">):</span>
        <span class="n">psi_targ_comp</span> <span class="o">=</span> <span class="n">gate</span> <span class="o">@</span> <span class="n">psi_in_comp</span>

        <span class="n">psi_in</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">comp_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi_in_comp</span>
        <span class="n">psi_targ</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">comp_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi_targ_comp</span>

    <span class="k">return</span> <span class="n">psi_in</span><span class="p">,</span> <span class="n">psi_targ</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h2 id="quotonic.training_sets.Tree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Tree</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></code>

<a href="#quotonic.training_sets.Tree" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Construct the training set for a QPNN that powers a tree-type photonic cluster state generation protocol.</p>
<p>In short, to power the tree-type photonic cluster state generation protocol, the QPNN should be trained to
perform CZ gate operations between the control photon in the first qubit slot (always initialized as
<span class="arithmatex">\(\left|+\right\rangle\)</span>) and all target photons that simultaneously enter the other qubit slots. If the
control photon enters alone, it should be routed through the network unchanged (i.e. an identity operation). For
more details on this set of operations, as well as the tree generation protocol in general, please see <a href="../qpnn/">qpnn</a> as well as <a href="https://doi.org/10.48550/arXiv.2505.14628">J. Ewaniuk <em>et al</em>., "Large-Scale Tree-Type Photonic Cluster State Generation with Recurrent
Quantum Photonic Neural Networks", arXiv:2505.14628 [quant-ph]</a>.</p>
<p>Unfortunately, there are many unit cell operations required for each given <span class="arithmatex">\(b\)</span>, and the format of these
operations changes in a complex way as <span class="arithmatex">\(b\)</span> increases. Thus, it is difficult to describe the output of this
function for any general <span class="arithmatex">\(b\)</span>. That being said, we provide an example output below for <span class="arithmatex">\(b = 2\)</span>, with the training
set shown using a truth table resolved in the computational basis, followed by the form of <code>comp_indices</code>.</p>
<table>
  <thead>
    <tr><th>$\left|\mathrm{in}\right\rangle$</th><th>$\left|\mathrm{targ}\right\rangle$</th></tr>
  </thead>
  <tbody>
    <tr><td>$\left|+\right\rangle$</td><td>$\left|+\right\rangle$</td></tr>
    <tr><td>$\left|++\right\rangle$</td><td>$\frac{1}{2}\left(\left|00\right\rangle +
    \left|01\right\rangle + \left|10\right\rangle - \left|11\right\rangle\right)$</td></tr>
    <tr><td>$\left|+-\right\rangle$</td><td>$\frac{1}{2}\left(\left|00\right\rangle -
    \left|01\right\rangle + \left|10\right\rangle + \left|11\right\rangle\right)$</td></tr>
    <tr><td>$\left|+0\right\rangle$</td><td>$\left|+0\right\rangle$</td></tr>
    <tr><td>$\left|+1\right\rangle$</td><td>$\left|-1\right\rangle$</td></tr>
    <tr><td>$\left|+++\right\rangle$</td><td>$\frac{1}{2\sqrt{2}}\left(\left|000\right\rangle +
    \left|001\right\rangle + \left|010\right\rangle + \left|011\right\rangle + \left|100\right\rangle
    - \left|101\right\rangle - \left|110\right\rangle + \left|111\right\rangle\right)$</td></tr>
    <tr><td>$\left|++-\right\rangle$</td><td>$\frac{1}{2\sqrt{2}}\left(\left|000\right\rangle -
    \left|001\right\rangle + \left|010\right\rangle - \left|011\right\rangle + \left|100\right\rangle
    + \left|101\right\rangle - \left|110\right\rangle - \left|111\right\rangle\right)$</td></tr>
    <tr><td>$\left|+-+\right\rangle$</td><td>$\frac{1}{2\sqrt{2}}\left(\left|000\right\rangle +
    \left|001\right\rangle - \left|010\right\rangle - \left|011\right\rangle + \left|100\right\rangle
    - \left|101\right\rangle + \left|110\right\rangle - \left|111\right\rangle\right)$</td></tr>
    <tr><td>$\left|+--\right\rangle$</td><td>$\frac{1}{2\sqrt{2}}\left(\left|000\right\rangle -
    \left|001\right\rangle - \left|010\right\rangle + \left|011\right\rangle + \left|100\right\rangle
    + \left|101\right\rangle + \left|110\right\rangle + \left|111\right\rangle\right)$</td></tr>
    <tr><td>$\left|+00\right\rangle$</td><td>$\left|+00\right\rangle$</td></tr>
    <tr><td>$\left|+01\right\rangle$</td><td>$\left|-01\right\rangle$</td></tr>
    <tr><td>$\left|+10\right\rangle$</td><td>$\left|-10\right\rangle$</td></tr>
    <tr><td>$\left|+11\right\rangle$</td><td>$\left|+11\right\rangle$</td></tr>
  </tbody>
</table>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">psi_in</span><span class="p">,</span> <span class="n">psi_targ</span><span class="p">,</span> <span class="n">comp_indices</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">psi_in</span><span class="p">)</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">psi_in</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">psi_in</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">psi_in</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">comp_indices</span><span class="p">)</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">comp_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">comp_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">array</span><span class="p">([[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">comp_indices</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">]])</span>
</code></pre></div>
<p>Above, we find that the <code>psi_in</code> (and correspondingly <code>psi_targ</code>) tuple contains 3 elements, for <span class="arithmatex">\(n = 1, 2,
3\)</span> respectively. At <span class="arithmatex">\(n = 1\)</span>, the computational basis has dimension 2, and there is one input-target pair to train
on. At <span class="arithmatex">\(n = 2\)</span> (<span class="arithmatex">\(n = 3\)</span>) the dimension is 4 (8) and there are 4 (8) input-target pairs to train on. The
<code>comp_indices</code> tuple also contains 3 elements organized in the same way, yet as we look at the arrays that make
up each element, we find that for <span class="arithmatex">\(n = 2\)</span> there are two unit cell operations that must be learnt,
each corresponding to a photon missing in a different qubit slot which changes the relevant logical states within
the second-quantized Fock basis. This is the form taken for any <span class="arithmatex">\(b\)</span>. The tuple is arranged according to photon
number, yet there may be more than one unit cell operation for a given <span class="arithmatex">\(n\)</span>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>b</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>maximum number of branches in the tree, <span class="arithmatex">\(b\)</span></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>psi_in</code></td>            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input states resolved in the computational basis for each <span class="arithmatex">\(1 \leq n \leq b + 1\)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>psi_targ</code></td>            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>target states resolved in the computational basis for each <span class="arithmatex">\(1 \leq n \leq b + 1\)</span></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>comp_indices</code></td>            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>indices within the relevant second-quantized Fock basis that correspond to computational basis
states, for each unit cell operation that exists for each <span class="arithmatex">\(1 \leq n \leq b + 1\)</span></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/quotonic/training_sets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">Tree</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]:</span>  <span class="c1"># noqa: C901</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the training set for a QPNN that powers a tree-type photonic cluster state generation protocol.</span>

<span class="sd">    In short, to power the tree-type photonic cluster state generation protocol, the QPNN should be trained to</span>
<span class="sd">    perform CZ gate operations between the control photon in the first qubit slot (always initialized as</span>
<span class="sd">    $\\left|+\\right\\rangle$) and all target photons that simultaneously enter the other qubit slots. If the</span>
<span class="sd">    control photon enters alone, it should be routed through the network unchanged (i.e. an identity operation). For</span>
<span class="sd">    more details on this set of operations, as well as the tree generation protocol in general, please see [qpnn](</span>
<span class="sd">    qpnn.md) as well as [J. Ewaniuk *et al*., &quot;Large-Scale Tree-Type Photonic Cluster State Generation with Recurrent</span>
<span class="sd">    Quantum Photonic Neural Networks&quot;, arXiv:2505.14628 [quant-ph]](https://doi.org/10.48550/arXiv.2505.14628).</span>

<span class="sd">    Unfortunately, there are many unit cell operations required for each given $b$, and the format of these</span>
<span class="sd">    operations changes in a complex way as $b$ increases. Thus, it is difficult to describe the output of this</span>
<span class="sd">    function for any general $b$. That being said, we provide an example output below for $b = 2$, with the training</span>
<span class="sd">    set shown using a truth table resolved in the computational basis, followed by the form of `comp_indices`.</span>

<span class="sd">    &lt;table&gt;</span>
<span class="sd">      &lt;thead&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;th&gt;$\\left|\\mathrm{in}\\right\\rangle$&lt;/th&gt;&lt;th&gt;$\\left|\\mathrm{targ}\\right\\rangle$&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;/thead&gt;</span>
<span class="sd">      &lt;tbody&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|+\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\left|+\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|++\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\frac{1}{2}\\left(\\left|00\\right\\rangle +</span>
<span class="sd">        \\left|01\\right\\rangle + \\left|10\\right\\rangle - \\left|11\\right\\rangle\\right)$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|+-\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\frac{1}{2}\\left(\\left|00\\right\\rangle -</span>
<span class="sd">        \\left|01\\right\\rangle + \\left|10\\right\\rangle + \\left|11\\right\\rangle\\right)$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|+0\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\left|+0\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|+1\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\left|-1\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|+++\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\frac{1}{2\\sqrt{2}}\\left(\\left|000\\right\\rangle +</span>
<span class="sd">        \\left|001\\right\\rangle + \\left|010\\right\\rangle + \\left|011\\right\\rangle + \\left|100\\right\\rangle</span>
<span class="sd">        - \\left|101\\right\\rangle - \\left|110\\right\\rangle + \\left|111\\right\\rangle\\right)$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|++-\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\frac{1}{2\\sqrt{2}}\\left(\\left|000\\right\\rangle -</span>
<span class="sd">        \\left|001\\right\\rangle + \\left|010\\right\\rangle - \\left|011\\right\\rangle + \\left|100\\right\\rangle</span>
<span class="sd">        + \\left|101\\right\\rangle - \\left|110\\right\\rangle - \\left|111\\right\\rangle\\right)$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|+-+\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\frac{1}{2\\sqrt{2}}\\left(\\left|000\\right\\rangle +</span>
<span class="sd">        \\left|001\\right\\rangle - \\left|010\\right\\rangle - \\left|011\\right\\rangle + \\left|100\\right\\rangle</span>
<span class="sd">        - \\left|101\\right\\rangle + \\left|110\\right\\rangle - \\left|111\\right\\rangle\\right)$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|+--\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\frac{1}{2\\sqrt{2}}\\left(\\left|000\\right\\rangle -</span>
<span class="sd">        \\left|001\\right\\rangle - \\left|010\\right\\rangle + \\left|011\\right\\rangle + \\left|100\\right\\rangle</span>
<span class="sd">        + \\left|101\\right\\rangle + \\left|110\\right\\rangle + \\left|111\\right\\rangle\\right)$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|+00\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\left|+00\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|+01\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\left|-01\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|+10\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\left|-10\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;tr&gt;&lt;td&gt;$\\left|+11\\right\\rangle$&lt;/td&gt;&lt;td&gt;$\\left|+11\\right\\rangle$&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;/tbody&gt;</span>
<span class="sd">    &lt;/table&gt;</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; b = 2</span>
<span class="sd">    &gt;&gt;&gt; psi_in, psi_targ, comp_indices = Tree(b)</span>
<span class="sd">    &gt;&gt;&gt; len(psi_in)</span>
<span class="sd">    3</span>
<span class="sd">    &gt;&gt;&gt; psi_in[0].shape</span>
<span class="sd">    (1, 2)</span>
<span class="sd">    &gt;&gt;&gt; psi_in[1].shape</span>
<span class="sd">    (4, 4)</span>
<span class="sd">    &gt;&gt;&gt; psi_in[2].shape</span>
<span class="sd">    (8, 8)</span>
<span class="sd">    &gt;&gt;&gt; len(comp_indices)</span>
<span class="sd">    3</span>
<span class="sd">    &gt;&gt;&gt; comp_indices[0]</span>
<span class="sd">    array([0, 1])</span>
<span class="sd">    &gt;&gt;&gt; comp_indices[1]</span>
<span class="sd">    array([[ 4, 5, 9, 10],</span>
<span class="sd">           [ 2, 3, 7, 8]])</span>
<span class="sd">    &gt;&gt;&gt; comp_indices[2]</span>
<span class="sd">    array([[13, 14, 16, 17, 28, 29, 31, 32]])</span>
<span class="sd">    ```</span>

<span class="sd">    Above, we find that the `psi_in` (and correspondingly `psi_targ`) tuple contains 3 elements, for $n = 1, 2,</span>
<span class="sd">    3$ respectively. At $n = 1$, the computational basis has dimension 2, and there is one input-target pair to train</span>
<span class="sd">    on. At $n = 2$ ($n = 3$) the dimension is 4 (8) and there are 4 (8) input-target pairs to train on. The</span>
<span class="sd">    `comp_indices` tuple also contains 3 elements organized in the same way, yet as we look at the arrays that make</span>
<span class="sd">    up each element, we find that for $n = 2$ there are two unit cell operations that must be learnt,</span>
<span class="sd">    each corresponding to a photon missing in a different qubit slot which changes the relevant logical states within</span>
<span class="sd">    the second-quantized Fock basis. This is the form taken for any $b$. The tuple is arranged according to photon</span>
<span class="sd">    number, yet there may be more than one unit cell operation for a given $n$.</span>

<span class="sd">    Args:</span>
<span class="sd">        b: maximum number of branches in the tree, $b$</span>

<span class="sd">    Returns:</span>
<span class="sd">        psi_in: input states resolved in the computational basis for each $1 \\leq n \\leq b + 1$</span>
<span class="sd">        psi_targ: target states resolved in the computational basis for each $1 \\leq n \\leq b + 1$</span>
<span class="sd">        comp_indices: indices within the relevant second-quantized Fock basis that correspond to computational basis</span>
<span class="sd">            states, for each unit cell operation that exists for each $1 \\leq n \\leq b + 1$</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># define the number of photons and number of optical modes</span>
    <span class="k">assert</span> <span class="n">b</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;the smallest useful tree has at least one section with 2 or more branches&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_tset_for_n</span><span class="p">(</span><span class="n">_n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="c1"># define the relevant single-qubit states that will be used to construct each input in the computational basis</span>
        <span class="n">Id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
        <span class="n">ket0</span> <span class="o">=</span> <span class="n">Id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ket1</span> <span class="o">=</span> <span class="n">Id</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ketp</span> <span class="o">=</span> <span class="n">logic</span><span class="o">.</span><span class="n">H</span><span class="p">()</span> <span class="o">@</span> <span class="n">ket0</span>
        <span class="n">ketm</span> <span class="o">=</span> <span class="n">logic</span><span class="o">.</span><span class="n">H</span><span class="p">()</span> <span class="o">@</span> <span class="n">ket1</span>

        <span class="k">if</span> <span class="n">_n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># if just one photon, it is |+&gt; and should be routed through unchanged</span>
            <span class="n">psi_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ketp</span><span class="p">)</span>
            <span class="n">psi_targ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ketp</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">psi_in</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">psi_targ</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if more than one photon, the circuit should apply CZ gates between the control (0) and all targets</span>
            <span class="n">CZs</span> <span class="o">=</span> <span class="p">[</span><span class="n">logic</span><span class="o">.</span><span class="n">CZ</span><span class="p">(</span><span class="n">control</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">_n</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">_n</span><span class="p">)]</span>
            <span class="n">circuit</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">,</span> <span class="n">CZs</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="c1"># build the training set, keeping in mind that the top qubit is |+&gt; for all input states,</span>
            <span class="c1"># and the other two qubits are swept over the X and Z computational bases</span>
            <span class="n">comp_basis</span> <span class="o">=</span> <span class="n">logic</span><span class="o">.</span><span class="n">build_comp_basis</span><span class="p">(</span><span class="n">_n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">K</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">comp_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">psi_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="n">_n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
            <span class="n">psi_targ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="n">_n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">basis</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span><span class="p">]):</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">comp_state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">comp_basis</span><span class="p">):</span>
                    <span class="c1"># construct input state in the computational basis, then get output by applying the circuit</span>
                    <span class="n">_psi_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ketp</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="n">comp_state</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">basis</span> <span class="o">==</span> <span class="s2">&quot;X&quot;</span><span class="p">:</span>
                            <span class="n">_psi_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">_psi_in</span><span class="p">,</span> <span class="n">ketp</span><span class="p">)</span> <span class="k">if</span> <span class="n">qubit</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">_psi_in</span><span class="p">,</span> <span class="n">ketm</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">basis</span> <span class="o">==</span> <span class="s2">&quot;Z&quot;</span><span class="p">:</span>
                            <span class="n">_psi_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">_psi_in</span><span class="p">,</span> <span class="n">ket0</span><span class="p">)</span> <span class="k">if</span> <span class="n">qubit</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">_psi_in</span><span class="p">,</span> <span class="n">ket1</span><span class="p">)</span>
                    <span class="n">psi_in</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">comp_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">_psi_in</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="o">**</span><span class="n">_n</span><span class="p">,))</span>
                    <span class="n">psi_targ</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">comp_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">circuit</span> <span class="o">@</span> <span class="n">_psi_in</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="o">**</span><span class="n">_n</span><span class="p">,))</span>
            <span class="k">return</span> <span class="n">psi_in</span><span class="p">,</span> <span class="n">psi_targ</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_comp_indices_for_n</span><span class="p">(</span><span class="n">_n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="c1"># compute all combinations of empty qubit slots (2 modes each) for the given number of qubits/photons</span>
        <span class="n">empty_slot_combos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">n</span> <span class="o">-</span> <span class="n">_n</span><span class="p">))</span>

        <span class="c1"># for each combination, prepare a corresponding list of empty modes and use this to prepare the indices of the</span>
        <span class="c1"># computational basis within the larger N-dimensional second quantization Fock basis</span>
        <span class="n">basis</span> <span class="o">=</span> <span class="n">build_secq_basis</span><span class="p">(</span><span class="n">_n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">comp_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">empty_slot_combos</span><span class="p">),</span> <span class="mi">2</span><span class="o">**</span><span class="n">_n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">empty_slots</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">empty_slot_combos</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">empty_slots</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">empty_modes</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">empty_modes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">empty_slots</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">slot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">empty_slots</span><span class="p">):</span>
                    <span class="n">empty_modes</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">slot</span>
                    <span class="n">empty_modes</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">slot</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">comp_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp_indices_from_secq</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">ancillary_modes</span><span class="o">=</span><span class="n">empty_modes</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">comp_indices</span>

    <span class="c1"># construct the full training set for each number of photons 1 &lt;= n &lt;= b + 1</span>
    <span class="n">psi_in</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">psi_targ</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">comp_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">psi_in_n</span><span class="p">,</span> <span class="n">psi_targ_n</span> <span class="o">=</span> <span class="n">build_tset_for_n</span><span class="p">(</span><span class="n">_n</span><span class="p">)</span>
        <span class="n">psi_in</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">psi_in_n</span><span class="p">)</span>
        <span class="n">psi_targ</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">psi_targ_n</span><span class="p">)</span>
        <span class="n">comp_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">build_comp_indices_for_n</span><span class="p">(</span><span class="n">_n</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">psi_in</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">psi_targ</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">comp_indices</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Maintained by <a href="https://www.linkedin.com/in/jacobewaniuk/">Jacob Ewaniuk</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/jewaniuk/quotonic" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/quotonic" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.tracking", "toc.integrate", "navigation.instant", "navigation.top", "navigation.tabs", "navigation.prune"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../js/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>